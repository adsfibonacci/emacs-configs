;; Package Initialization
(require 'package)
(add-to-list 'package-archives '("elpa" . "https://elpa.gnu.org/packages/"))
(add-to-list 'package-archives '("melpa" . "https://stable.melpa.org/packages/"))
(add-to-list 'package-archives '("melpa-devel" . "https://melpa.org/packages/"))
(add-to-list 'package-archives '("org" . "https://orgmode.org/elpa/"))
(package-initialize)

(setq debug-on-error t)

;;(require 'ox-latex)
(require 'yasnippet)
(yas-global-mode 1)

(add-hook 'prog-mode-hook #'hs-minor-mode)

(require 'elcord)
(elcord-mode)

(require 'neotree)
(global-set-key [f8] 'neotree-toggle)

(global-auto-revert-mode t)
(add-hook 'prog-mode-hook 'display-line-numbers-mode)
(add-hook 'org-mode-hook 'display-line-numbers-mode)

(add-hook 'org-mode-hook #'org-modern-mode)
(add-to-list 'org-latex-packages-alist '("" "minted"))
(setq org-src-fontify-natively t)
(setq org-src-tab-acts-natively t)
(setq org-hide-emphasis-markers t)
(setq org-confirm-babel-evaluate nil)
(setq org-edit-src-content-indentation 4)
(setq-default org-startup-indented nil)
(setq org-src-preserve-indentation t)
(setq confirm-kill-processes nil)
(setq-default tab-width 4)
(setq-default org-pretty-entities t)
(setq org-latex-listings 'minted)
(add-to-list 'org-latex-packages-alist '("" "minted"))
(setq org-latex-pdf-process
      '("pdflatex -shell-escape -interaction nonstopmode -output-directory %o %f"
        "bibtex %b"    ; Run BibTeX for bibliography files, if used.
        "pdflatex -shell-escape -interaction nonstopmode -output-directory %o %f"
        "pdflatex -shell-escape -interaction nonstopmode -output-directory %o %f"))
(add-hook 'org-mode-hook 'visual-line-mode)

;;(setq org-babel-default-header-args
;;      (org-combine-plists
;;       '((:eval . "no")
;;         (:noweb . "yes"))
;;       org-babel-default-header-args))
;;(setq org-babel-default-header-args:latex
;;      (org-combine-plists
;;       '((:eval . "yes")
;;         (:noweb . "yes"))
;;       org-babel-default-header-args))
;;
	  
;; Appearance and functionality
(load-theme 'atom-one-dark t)
(menu-bar-mode -1)
(scroll-bar-mode -1)
(tool-bar-mode -1)
(set-frame-parameter nil 'alpha-background 100)
(add-to-list 'default-frame-alist '(alpha-background . 100))

;; Set Environment Variables
(setq inhibit-startup-screen t)
(setq backup-directory-alist `(("." . ,"~/.emacs.d/.backups")))
(setq make-backup-files t
      backup-by-copying t
      version-control t
      delete-old-versions t
      delete-by-moving-to-trash t
      kept-old-versions 6
      kept-new-versions 9
      auto-save-default t
      auto-save-timeout 20
      auto-save-interval 200
      )
(set-face-foreground 'font-lock-comment-face "#C28aa1")
(defalias 'yes-or-no-p 'y-or-n-p)

;; Emacs Usability Hooks
(add-hook 'emacs-startup-hook (lambda () (interactive) (ansi-term (getenv "SHELL"))))

(setenv "WORKON_HOME" "~/.virtualenvs/python-venv")
(pyvenv-mode)
(pyvenv-activate "~/.virtualenvs/python-venv")

;; Emacs Keybinds
(global-set-key (kbd "C-h C-r") 'reload-init)
(global-set-key (kbd "C-x C-b") 'buffer-menu)
(global-set-key (kbd "M-s M-s") (lambda () (interactive) (ansi-term (getenv "SHELL"))))

(defun reload-init ()
  "Reloading Emacs Init"
  (interactive)
  (load-file user-init-file))

(custom-set-variables
 ;; custom-set-variables was added by Custom.
 ;; If you edit it by hand, you could mess it up, so be careful.
 ;; Your init file should contain only one such instance.
 ;; If there is more than one, they won't work right.
 '(display-line-numbers-grow-only t)
 '(display-line-numbers-widen nil)
 '(display-line-numbers-width 2)
 '(elcord-boring-buffers-regexp-list
   '("^ " "\\\\*Messages\\\\*" "\\\\*ansi-term\\\\*" "\\\\*Customize Group: Elcord\\\\*" "\\\\*Buffer List\\\\*"))
 '(elcord-display-buffer-details t)
 '(elcord-display-line-numbers nil)
 '(elcord-editor-icon nil)
 '(elcord-idle-message "Researching...")
 '(elcord-idle-timer 600)
 '(elcord-quiet t)
 '(elcord-refresh-rate 10)
 '(org-babel-load-languages
   '((emacs-lisp . t)
	 (C . t)
	 (R . t)
	 (python . t)
	 (latex . t)
	 (shell . t)))
 '(package-selected-packages
   '(## atom-one-dark-theme auctex chatgpt-shell elcord linum-off lsp-latex lsp-ui magit neotree org-modern pdf-tools pyvenv yasnippet))
 '(warning-suppress-types '((ox-latex))))
(custom-set-faces
 ;; custom-set-faces was added by Custom.
 ;; If you edit it by hand, you could mess it up, so be careful.
 ;; Your init file should contain only one such instance.
 ;; If there is more than one, they won't work right.
 '(font-lock-string-face ((t nil)))
 '(line-number ((t (:background "gray8" :foreground "thistle" :slant italic :width ultra-condensed))))
 '(line-number-current-line ((t (:background "gray20" :foreground "thistle" :slant italic :width ultra-condensed))))
 '(line-number-major-tick ((t (:background "grey75" :weight bold))))
 '(org-block ((t (:background "gray5" :foreground "dim gray" :weight semi-bold)))))
(provide 'init)
